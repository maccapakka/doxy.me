---
description: "Component documentation requirements: unit tests, Storybook stories, and LLM documentation"
globs:
  - "**/components/**/*.tsx"
alwaysApply: false
---

# Component Documentation

When modifying any component, always update the corresponding test and documentation files.

## File Co-location

Documentation files are co-located with the component:

```
ComponentName/
├── ComponentName.tsx           # Component (when this changes...)
├── ComponentName.unit.tsx      # Update tests
└── ComponentName.llm.md        # Update LLM docs
```

---

## Unit Tests

### Requirements

1. **Always update the `.unit.tsx` file** when changing component logic, props, or behavior
2. **Add new test cases** for new functionality, props, or edge cases
3. **Update existing tests** if expected behavior changes
4. **Ensure tests cover**:
   - All props and their variations
   - User interactions (clicks, inputs, etc.)
   - Conditional rendering logic
   - Accessibility requirements

### Test Pattern

Use Vitest with React Testing Library:

```tsx
import { describe, it, expect, vi } from "vitest";
import { render, screen, fireEvent } from "@testing-library/react";
import { ComponentName } from "./ComponentName";

describe("ComponentName", () => {
  it("should render correctly", () => {
    render(<ComponentName />);
    // assertions
  });

  it("should handle user interaction", () => {
    const handleClick = vi.fn();
    render(<ComponentName onClick={handleClick} />);
    fireEvent.click(screen.getByRole("button"));
    expect(handleClick).toHaveBeenCalled();
  });
});
```

---

## Storybook Stories

### Rich Documentation

Every component should have rich Storybook documentation using parameters. This creates professional, informative docs pages.

**Meta-level documentation** (in `const meta`):

| Property | Purpose |
|----------|---------|
| `parameters.docs.subtitle` | Brief tagline displayed under the component title |
| `parameters.docs.description.component` | Detailed component overview (supports markdown) |

**Story-level documentation** (on each story):

| Property | Purpose |
|----------|---------|
| `name` | Display name in sidebar/docs (cleaner than export name) |
| `parameters.docs.description.story` | Explains the story's purpose |

### Meta Pattern

```tsx
const meta: Meta<typeof ComponentName> = {
  component: ComponentName,
  title: "Components/ComponentName",
  tags: ["autodocs"],
  parameters: {
    docs: {
      subtitle: "Brief tagline describing the component",
      description: {
        component:
          "Detailed description of the component. Explain its purpose, key features, and when to use it. Supports `markdown` formatting.",
      },
    },
  },
  argTypes: { /* ... */ },
};
```

### Story Pattern

```tsx
export const Default: Story = {
  name: "Typography Scale",
  parameters: {
    docs: {
      description: {
        story:
          "Explains what this story demonstrates and when to use this pattern.",
      },
    },
  },
  render: () => <ComponentName />,
};
```

### ArgTypes Categories

Always group `argTypes` into semantic categories using `table.category`. This organizes the Controls panel into collapsible sections.

**CRITICAL: Every prop must be filed under the correct category using `table.category`. Never leave props uncategorized.**

**Standard categories** (use these when applicable):

| Category | Props |
|----------|-------|
| Element | `as`, `children`, `className`, `id`, `ref` |
| Layout | `direction`, `alignItems`, `alignSelf`, `justifyContent`, `justifySelf`, `wrap` |
| Spacing | `gap`, `padding`, `paddingBlock`, `paddingInline`, `margin`, etc. |
| Styling | `background`, `color`, `variant`, `size` |
| State | `disabled`, `loading`, `selected`, `open` |
| Events | `onClick`, `onChange`, `onFocus`, `onBlur` |

### ArgTypes Pattern

```tsx
const meta: Meta<typeof ComponentName> = {
  component: ComponentName,
  argTypes: {
    // Element
    as: {
      description: "The element type to render",
      control: "select",
      options: ["div", "section", "article"],
      table: { category: "Element" },
    },
    children: {
      description: "The content to display",
      control: "text",
      table: { category: "Element" },
    },
    // Layout
    direction: {
      description: "Flex direction",
      control: "select",
      options: ["row", "column"],
      table: { category: "Layout" },
    },
    // Spacing
    gap: {
      description: "Gap between children",
      control: { type: "range", min: 1, max: 12 },
      table: { category: "Spacing" },
    },
  },
};
```

### Story Organization

Group stories by logical concern rather than creating separate stories for each prop value. This creates more effective documentation that's easier to navigate and understand.

**Benefits:**

- Cleaner, more scannable documentation
- Easier comparison of related variants side-by-side
- Fewer repetitive story definitions
- Better understanding of the full range of options

**Guidelines:**

1. **Consolidate related variations** - Group stories that demonstrate different values of the same prop into a single comprehensive story
2. **Use descriptive labels** - Use the `Text` component with appropriate variants to clearly label each variation being demonstrated
3. **Show complete option sets** - For enum-like props, show all available values in one story for easy comparison
4. **Group semantic patterns** - Combine semantic HTML aliases (Section, Article, Header, etc.) into one story
5. **Group layout patterns** - Combine related layout shortcuts (Stack, Cluster, etc.) into one story

**Example:**

See `Box.stories.tsx` for reference implementation:

| Story | Demonstrates |
|---|---|
| Flex Direction | All 4 direction values (row, column, row-reverse, column-reverse) |
| Justify Content | All 6 justifyContent values (flex-start, center, flex-end, space-between, space-around, space-evenly) |
| Align Items | All 5 alignItems values (flex-start, center, flex-end, stretch, baseline) |
| Background Colors | All 7 color tokens (primary, secondary, accent, warning, positive, critical, neutral) |
| Semantic Elements | All 5 semantic aliases (Section, Article, Header, Footer, Aside) |
| Layout Aliases | Stack and Cluster patterns together |

Each variation within a story should be wrapped in a container with a `Text` label explaining which variant is being shown.

---

## LLM Documentation

The `.llm.md` file provides AI assistants with optimized documentation to:

- Understand how to use the component correctly
- Generate accurate code using the component
- Know the available props and their types
- Understand the component's intended use cases

### Required Sections

Every `ComponentName.llm.md` must include:

1. **Component Name** - H1 header with the component name
2. **Import** - How to import the component
3. **Usage** - Basic usage example
4. **Props** - Table of all props with types, defaults, and descriptions
5. **Examples** - Multiple usage examples covering common scenarios

### Recommended Sections

- **Variants** - If the component has visual variants
- **Sizes** - If the component has size options
- **Accessibility** - Relevant a11y considerations

### Template

```markdown
# ComponentName

Brief description of the component.

## Import

\`\`\`tsx
import { ComponentName } from "design-system/components";
\`\`\`

## Usage

\`\`\`tsx
<ComponentName prop="value">Content</ComponentName>
\`\`\`

## Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `propName` | `type` | `default` | Description |

## Examples

### Example Name

\`\`\`tsx
<ComponentName>Example</ComponentName>
\`\`\`
```

---

## When to Update

Update these documentation files when:

- Adding, removing, or modifying props
- Changing default values
- Adding new variants or sizes
- Changing the component's behavior
- Adding new usage patterns
- Fixing bugs that change expected behavior
